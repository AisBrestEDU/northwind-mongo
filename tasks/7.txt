Create a query to return all employees and full name of person to whom this employee reports to:

| EmployeeId | FullName | ReportsTo |

Full Name - title of courtesy with full name.
Order data by first column.
Reports To - Full name. If the employee does not report to anybody leave "-" in the column.

DB FIX:

db.getCollection('employees').find({FirstName:"NULL"}).forEach(function(empl){
    empl.FirstName = null
    db.employees.save(empl)
})

QUERY:

db.employees.aggregate([
    {
        $lookup: {
            from: "employees",
            localField: "ReportsTo",
            foreignField: "EmployeeID",
            as: "employees"
        }
    },
    { $unwind: { path: "$employees", preserveNullAndEmptyArrays: true } },
    {
        $project: {
            _id: 0,
            EmployeeID: 1,
            FullName: { $concat:[ {$ifNull: ["$LastName"," "] }, {$ifNull: ["$FirstName",""] }]},
            ReportsTo: {
                $cond:{
                    if: "$employees",
                    then: { $concat:[ {$ifNull: ["$employees.LastName",""] }, " ", "$employees.FirstName" ] },
                    else: "-" 
                }
            }
        }
    }
])
