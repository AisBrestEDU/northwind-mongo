Create a SQL query to find the employee that sold products for the largest amount:

| EmployeeId | Employee Full Name | Amount, $ |

// SELECT TOP (1) E.EmployeeID, E.FirstName + ' ' + E.LastName AS FullName, SUM(OD.UnitPrice * OD.Quantity) AS [Amount, $]
// FROM Northwind.dbo.Employees E
// JOIN Northwind.dbo.Orders O ON E.EmployeeID = O.EmployeeID
// JOIN Northwind.dbo.[Order Details] OD ON O.OrderID = OD.OrderID
// GROUP BY E.EmployeeID, E.FirstName, E.LastName
// ORDER BY [Amount, $] DESC

db.employees.aggregate([
    {
        $lookup:
        {
            from: "orders",
            localField: "EmployeeID",
            foreignField: "EmployeeID",
            as: "orders_docs"
        }
    },
    { $unwind: "$orders_docs" },
    {
        $lookup:
        {
            from: "order-details",
            localField: "orders_docs.OrderID",
            foreignField: "OrderID",
            as: "order_details_docs"
        }
    },
    { $unwind: "$order_details_docs" },
    { 
        $group: 
        { 
            _id: { EmployeeID: "$EmployeeID", FullName: { $concat: ["$FirstName", " ", "$LastName"] } }, 
            "Amount, $": { $sum: { $multiply: [ "$order_details_docs.UnitPrice", "$order_details_docs.Quantity" ] } }
        } 
    },
    { $sort: { "Amount, $": -1 } },
    { $limit: 1 }
])
